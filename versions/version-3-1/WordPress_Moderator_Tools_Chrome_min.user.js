// ==UserScript==
// @name        WordPress Moderator Tools
// @namespace   WordPress_moderator_tools
// @description Adds keyboard shortcut navigation (and more) for WordPress forum moderators.
// @include     *://*wordpress.org/support/bb-admin/posts.php*
// @include     *://*wordpress.org/support/bb-admin/topics.php*
// @include     *://*wordpress.org/support/profile/*
// @include     *://*wordpress.org/support/forum/*
// @include     *://*wordpress.org/support/topic/*
// @include     *://*wordpress.org/support/edit.php?id=*
// @include     *://*wordpress.org/support/view/plugin-reviews/*
// @include     *://*wordpress.org/support/view/theme-reviews/*
// @include     *://*wordpress.org/tags/modlook
// @version     3.1
// @downloadURL https://github.com/keesiemeijer/WordPress-moderator-tools/raw/master/WordPress_Moderator_Tools_Chrome.user.js
// @updateURL https://github.com/keesiemeijer/WordPress-moderator-tools/raw/master/WordPress_Moderator_Tools_Chrome.user.js
// @grant       none
// ==/UserScript==

function moderator_tools_with_jquery(b){var a=document.createElement("script");a.type="text/javascript";a.textContent="("+b.toString()+")(jQuery)";document.body.appendChild(a)}moderator_tools_with_jquery(function(K){var U="hide";var g="#e3cebd";var J="#moderator_tools_menu{position:fixed;top:10px;left:65px;background:white;border:3px solid #333333; color:#333333; padding: 0 3em 0 10px;}#moderator_tools_menu a{text-decoration:none;border:none;}#moderator_tools_menu a:hover{color:#d54e21;}#wordpress-org #moderator_tools_menu{font-size:13px}#wordpress-org #moderator_tools_menu .wpmt_close_menu span{display:none; }.wpmt_stats{padding-bottom:1em;}.wpmt_stats span{display:inline-block;margin:5px 0;}.wpmt_shortcuts_help{margin-left:5px;} .wpmt_shortcut{background-color:#cae8f7;padding:1px 3px;display:inline-block;margin-bottom:4px;font-weight:bold}.wpmt_shortcuts_title{display:block;font-weight:bold;margin:1em 0}#wordpress-org .wpmt_shortcuts_title{display:inline}.wpmt_shortcuts_top{margin-bottom:1em}.wpmt_close_menu{position: absolute; right: 0; top: 5px;padding:0;margin:4px 1em 0 0; }.wpmt_close_menu a{font-size:1.8em;border:0;}.wpmt_is_admin .wpmt_close_menu a{font-size:1.5em;}.wpmt_menu_state{margin-right:40px}.wpmt_profile_edit{display:block;margin-top:5px}.wpmt_modlook{background-color:#efeef5;margin-left:.5em;padding:1px 2px;}.wpmt_ip-warning{color:red;}",e="wpmt_current",aa="https://wordpress.org/support/bb-admin",D='<span class="wpmt_shortcuts_title">Shortcuts available for this page:</span>',b=K('<div id="moderator_tools_menu"></div>'),w=K('<span class="wpmt_close_menu"><a href="#" >&times;</a></span>'),H=K('<span class="wpmt_menu_state"></span>'),R=K('<p class="wpmt_shortcuts_top"></p>'),i={},C={},E=false,a=false,d=false,N=true,f,O,q,z,Z;var h={ANT:new RegExp('id="elf_not_trusted".+?checked="checked"',"gi"),EditPost:new RegExp(".+?/support/edit.php.+?","gi"),username:new RegExp('id="userlogin">(.+?)<',"gi")};var G={a:"%a% - <span class='wpmt_select'>select</span>/deselect all posts",d:"%d% - loop through Bulk Actions dropdown options",e1:"%e% - edit the user profile from the current post in a new tab.",e2:"%e% - refresh this profile page",e3:"%e% - open the edit profile page in a new tab",e4:"%e% - open the current post's user profile page in a new tab",h:"%h% - show/hide shortcuts",i:"%i% - edit all user profiles from <span class='wpmt_select'>selected posts</span> in new tabs.",shift_i:"%shift i% to edit non bozo user profiles only",m:"%m% - show/hide menu",n:"%n% - go to User Activity",r:"%r% - open the user's bb-admin posts page in a new tab",s:"%s% - <span class='wpmt_select'>select</span>/deselect current post",v:"%v% - view current post in a new tab",w:"%w% - remove website url (or add it back)",x:'%x% - select/deselect "Akismet Never Trust" checkbox',z:'%z% - select/deselect "This user is a bozo" checkbox',z_x:"%z% - go to the next normal profile post | %x% - go to the previous normal profile post",shift_z_x:"%shift z% - go to the next bozo profile post | %shift x% - go to the previous bozo profile post",t_b:"%t% - go to the top of this page  | %b% - go to the bottom of this page",n_p:"%n% - go to the next post | %p% - go to the previous post",click_author:"%mouse click% - Click in the Author column to <span class='wpmt_select'>select</span>/deselect a post (also sets the post to current)",click_post:"%mouse click% - Click anywhere in a post to set it to current, for navigation with the shortcuts %n% and %p% (see above)"};function T(){if(s(K("#moderator_tools_menu"))||s(K("#moderator_tools_ed_uncap"))){return}var ab=true;if(s(K("#posts-list"))){a=true;d=true;P("posts")}if(s(K("#topics-list"))){a=true;d=true;P("topics")}if(!a){var ac=K(".mod-login");if(s(ac)){d=true;K("head").append('<style type="text/css">#headline .login{text-align:right;}</style>');ac.append(' | <a href="'+aa+'/posts.php?forum_id=0&post_status=2">Spam Queue</a> | <a href="https://wordpress.org/tags/modlook">Modlook</a>');if(s(K("#profile-form"))){L()}if(s(K(".edit-form"))){j();ab=false}if(s(K(".forumlist"))){V(".widefat")}if(s(K(".all-reviews"))){l()}}if(s(K("#user-replies"))||s(K("#user-threads"))){o()}if(s(K("#thread"))){v()}}else{b.addClass("wpmt_is_admin")}if(ab){Y();I();r()}A();u()}function P(ac){var ae=(ac==="topics")?"topic":"post";C={bulk_actions:"",topics:ac==="topics"?true:false,column:".check-column > input",author:K("td.author"),toggle:K('<a href="#">shortcuts</a>'),help:K(' <span class="wpmt_shortcuts_help">(h) </span>'),stats:K('<span class="wpmt_stats"></span>')};C.bulk_actions_checkbox=K("thead tr "+C.column+",tfoot tr "+C.column);var ab="table.widefat tr.wpmt_current td{border:solid #9f9f9f;border-width:2px 0}table.widefat tr.wpmt_current td.check-column{border-left:2px solid #9f9f9f}table#posts-list tr.wpmt_current td.date,table#topics-list tr.wpmt_current td.freshness{border-right:2px solid #9f9f9f}{border-right:2px solid #9f9f9f}.wpmt_bozo_profile{display:block;margin-top:10px;color:white;text-align:center;background:red}.wpmt_profile_type{padding:4px 6px;border:1px solid red}.wpmt_profile_type.wpmt_green{border:1px solid green}.wpmt_selected,.wpmt_select{background-color: "+g+";}.wpmt_profile_type.wpmt_selected{padding: 5px 7px;border:none;}";K("head").append('<style type="text/css">'+J+ab+"</style>");var ad=k([G.m,G.t_b,G.n_p,G.h,G.d,G.a,G.s,G.v,G.e1,G.i]);if(!C.topics){ad=ad.replace(/<br\/>$/g,"");ad+=" | "+k([G.shift_i,G.z_x,G.shift_z_x])}ad+=k([G.click_author,G.click_post]);ad=(C.topics)?ad.split("post").join(ae):ad;C.shortcuts=K('<p style="display: none;">'+D+ad+"</p>");b.append(C.stats,C.help,C.toggle,w,C.shortcuts);K("body").append(b);K("#bbUserInfo > p").prepend(H);c();q="tr."+e;z="tr:first";Z=K("#"+ac+"-list tbody tr");f=K("#bbHead");O=Z.last();X();m()}function L(){var ac=K("#user_url");C={website:ac,site_url:ac.val(),bozo:K("input#is_bozo"),askimet:K("#elf_not_trusted")};K("head").append('<style type="text/css">'+J+"</style>");var ab=G.n_p.split("post").join("section");var ad=k([G.m,G.t_b,ab,G.e2,G.r,G.w,G.z,G.x]);R.append(D,w);ad="<p>"+ad+"</p>";b.append(R,ad);K("body").append(b);H.insertBefore(K("#profile-form")).wrap("<p></p>");c();q="#profile-form h3."+e;z="h3.wpmt_section:first";Z=K("#profile-form h3");Z.addClass("wpmt_section");K("h3:contains('Mailing Lists')").removeClass("wpmt_section");K("h3:contains('Administration')").addClass("wpmt_admin_section");K("label[for='user_url']").append(y(" %(w)%"));K("label[for='is_bozo']").append(y(" %(z)%"));K("label[for='elf_not_trusted']").append(y(" %(x)%"));f=K("#wporg-header");O=K("#wporg-footer");Q();t()}function o(){K("head").append('<style type="text/css">'+J+"</style>");var ac=k([G.m,G.t_b,G.n]);if(d){ac+=k([G.e3,G.r])}R.append(D,w);ac="<p>"+ac+"</p>";b.append(R,ac);K("body").append(b);var ab=K(".topicnav").first().find("p");ab.css("margin","0 0 .5em");H.insertAfter(ab).wrap("<p></p>");c();K.each(["#user-replies","#user-threads"],function(ad,ae){V(ae)});q="#useractivity."+e;z=0;Z=K("#useractivity");f=K("#wporg-header");O=K("#wporg-footer");if(d){Q()}}function v(){C={tags:K("#yourtaglist"),author:".threadauthor > p > strong"};var ab=".wpmt_current .authortitle a {background-color: #efeef5;padding: 3px 6px;margin: 3px 0;display: inline-block;}.wpmt_ip-warning{color:red;}";K("head").append('<style type="text/css">'+J+ab+"</style>");var ad="<p>"+k([G.m,G.t_b,G.n_p,G.e4,G.click_post])+"</p>";R.append(D,w);b.append(R,ad);K("body").append(b);var ac=K(".topicnav").first().find(".bbcrumb");ac.css("margin","0 0 .5em");H.insertAfter(ac).wrap("<p></p>");c();q="li."+e;z="li:first";Z=K(".postitem");f=K("#wporg-header");O=Z.last();if(s(Z)>1){S()}B();F();if(Z.length===1){Z.first().trigger("click.wpmt")}}function l(){Z=K(".reviewer");if(s(Z)<2){return}C={author:".reviewer-name"};K("head").append('<style type="text/css">'+J+"</style>");S()}function t(){K("html").bind("keydown.wpmt",function(af){var ab=n(af);var ae;if((E!==false)||(1!==ab)){return}if((87===af.keyCode)&&(s(C.website)===1)){K(q).removeClass(e);ae=Z.first();ae.addClass(e);W(ae);if(C.site_url){if(""===C.website.val()){C.website.val(C.site_url)}else{C.website.val("")}clearTimeout(ad);C.website.parents("tr").css("background-color","#FFFFCC");var ad=setTimeout(function(){C.website.parents("tr").css("background-color","#FFFFFF")},300)}}if(af.keyCode===90||af.keyCode===88){var ac=(af.keyCode===90)?C.bozo:C.askimet;if(ac){K(q).removeClass(e);ae=K("h3.wpmt_admin_section").addClass(e);if(s(ae)===1){W(K(ae));if(ac.attr("checked")){ac.removeAttr("checked")}else{ac.click()}clearTimeout(ag);ac.parents("tr").css("background-color","#FFFFCC");var ag=setTimeout(function(){ac.parents("tr").css("background-color","#FFFFFF")},300)}}}})}function F(){Z.bind("click.wpmt",function(ab){if(ab.target.nodeName!=="A"){x();K(this).addClass(e)}});K("html").bind("keydown.wpmt",function(ae){if(E!==false){return}var ac=n(ae);var ad=K(q);if(s(ad)){var ab=K(ad).find(".authortitle a");if(s(ab)){if((ae.keyCode===69)&&(ac=1)){M(ab.attr("href"))}}}});K('[class^="delete:yourtaglist:"]').click(function(ad){if(N){ad.preventDefault();var ac=K(this).closest("li"),ab=K(this).attr("href");K.ajax({url:ab,async:true,dataType:"html",success:function(ae){ac.fadeOut()}})}})}function m(){K("html").bind("keydown.wpmt",function(aj){if(E!==false){return}var ai=n(aj);var ak,ac;if((aj.keyCode===83)&&(ai===1)){ak=K(q);if(s(ak)===1){W(ak);var ad=ak.find(C.column);ad.attr("checked",!ad.attr("checked"));X()}}if((aj.keyCode===86)&&(ai===1)){ak=K(q);if(s(ak)){var an=C.topics?ak.find(".row-title > a:first"):ak.find(".row-actions > a:first");if(s(an)){if(C.topics){ac=an.attr("href")}else{ac=(an.text()==="View")?an.attr("href"):0}if(ac.length){M(ac)}}}}if((aj.keyCode===68)&&(ai===1)){K(".bulk-form select[name=action] > option:selected").removeAttr("selected").next("option").attr("selected","selected")}if((aj.keyCode===65)&&(ai===1)){C.bulk_actions=(C.bulk_actions_checkbox.attr("checked"))?"off":"on";p()}if((aj.keyCode===72)&&(ai===1)){C.shortcuts.toggle();ak=K(q);if(s(ak)){W(ak)}}if(i.hasOwnProperty(73)){var ag,am=[],al=false;if(!C.topics&&(i.hasOwnProperty(16)&&ai===2)){al=true;ag=K(".wpmt_normal_post").find(".post_selected")}else{if(ai===1){al=true;ag=K(".post_selected")}}if(al&&s(ag)){ag.each(function(){ac=K(this).children().first("a").attr("href");if(am.indexOf(ac)===-1){am.push(ac);M(ac+"/edit")}})}}if((aj.keyCode===69)&&(ai===1)){ak=K(q);if(s(ak)===1){ac=ak.find(".wpmt_profile_edit > a").attr("href");if(ac.length){M(ac)}}}if(!C.topics&&(Z.length>=1)){if(i.hasOwnProperty(90)||i.hasOwnProperty(88)){var af=(i.hasOwnProperty(16)&&(ai===2))?"bozo":"normal";var ao=i.hasOwnProperty(90)?"z":"x",ae=K(".wpmt_"+af+"_post");if(s(ae)){if(!s(K(q))){if(ao==="z"||((ae.length===1)&&ao==="x")){ak=ae.first();ak.addClass(e);W(ak)}}else{if(ae.length===1){var ah=ae.first();x();ah.addClass(e);W(ah)}else{var ab;ak=K(q);if(ao==="z"){ab=ak.nextAll(".wpmt_"+af+"_post:first")}if(ao==="x"){ab=ak.prevAll(".wpmt_"+af+"_post:first")}if(s(ab)){x();ab.addClass(e);W(ab)}}}}}}});if(N){K(".post-delete-link, .post-spam-link").click(function(ad){ad.preventDefault();var ac=K(this).closest("tr"),ab=K(this).attr("href");K.ajax({url:ab,async:true,dataType:"html",success:function(ae){ac.fadeOut()}})})}C.bulk_actions_checkbox.bind("click.wpmt",function(){C.bulk_actions=(K(this).attr("checked"))?"on":"off";p()});Z.bind("click.wpmt",function(ab){if(ab.target.nodeName!=="A"){K("tbody tr").removeClass(e);K(this).addClass(e)}});K("tbody > tr > "+C.column).bind("click.wpmt",function(ab){X()});C.author.bind("click.wpmt",function(ab){if(ab.target.nodeName!=="A"){X(K(this).parent().attr("id"))}});C.toggle.bind("click.wpmt",function(ab){ab.preventDefault();C.shortcuts.toggle()});w.bind("click.wpmt",function(ab){ab.preventDefault();C.shortcuts.hide()})}function Q(){var ab=K("#profile-menu");var ag;var ad;var af;if(s(ab)){ag=ab.find("a").filter(function(ah){return K(this).text()==="Edit"})}else{return}if(s(ag)){ag.text("Edit (e)");ad=ag.attr("href");var ac=K("#userlogin");if(s(ac)){af=aa+"/posts.php?forum_id=0&post_author="+ac.text();var ae=K('<li><a href="'+af+'">bb-admin (r)</a></li>');ag.parent().after(ae)}}if(!(ad.length||af.length)){return}K("html").bind("keydown.wpmt",function(ai){var ah=n(ai);if((E!==false)||(ah!==1)){return}if((ai.keyCode===69)&&(ad.length)){if(s(K("#profile-form"))){location.reload(true)}else{M(ad)}}if((ai.keyCode===82)&&(af.length)){M(af)}})}function Y(){var ab;K("html").bind("keydown.wpmt",function(ae){if(E!==false||(typeof(Z)==="undefined")){return}var ad=n(ae);if(!(ae.keyCode===78||ae.keyCode===80)||(ad!==1)){return}var ac=ae.keyCode===78?"n":"p";if(!s(K(q))){if(ac==="n"){ab=Z.first();W(ab);ab.addClass(e)}}else{ab=K(q);if(ac==="n"){if(s(ab.nextAll(z))){ab.removeClass(e).nextAll(z).addClass(e);W(K(q))}else{W(K(q))}}if(ac==="p"){if(s(ab.prevAll(z))){ab.removeClass(e).prevAll(z).addClass(e);W(K(q))}else{ab.removeClass(e);if(s(f)&&z){W(f)}}}}})}function I(){K("html").bind("keydown.wpmt",function(ac){if(E!==false){return}var ab=n(ac);if(s(f)&&(ac.keyCode===84)&&(ab===1)){W(f);if(typeof(Z)!=="undefined"){x()}}if(s(O)&&(ac.keyCode===66)&&(ab===1)){W(O);if(typeof(Z)!=="undefined"){x();Z.last().addClass(e)}}})}function r(){w.bind("click.wpmt",function(ac){ac.preventDefault();b.toggle();U=(b.is(":visible"))?"show":"hide";c();var ab=K(q);if(s(ab)){W(ab)}});K("html").bind("keydown.wpmt",function(ac){if(E!==false){return}var ab=n(ac);if((ac.keyCode===77)&&(ab===1)){w.trigger("click.wpmt")}})}function p(){C.author.each(function(){var ab=K(this).parent().find(C.column);if(C.bulk_actions==="on"){ab.attr("checked",true)}else{ab.attr("checked",false)}});X();C.bulk_actions=false}function X(ag){C.stats.empty();var af=0;C.author.each(function(){var am=K(this).parent().children(".check-column").css("background-color"),aj=K.trim(K(this).children().first("a").text()),ak=K(this).parent().find(C.column);K(this).css("background",am);if(!s(K(this).children(".wpmt_profile_edit"))){var ai=K("img",K(this).children().first("a")),ah='<br/><span class="wpmt_profile_edit"><a href="'+K(this).children().first("a").attr("href")+'/edit">Edit Profile</a></span>';if(aj.indexOf("(BOZO)")>=0){aj=K.trim(aj.replace("(BOZO)",""));K(this).children().first("a").text(" "+aj);if(ai){K(this).children().first("a").prepend(ai)}if(N){var al=K(this).children().first("a");K.ajax({url:al.attr("href")+"/edit",async:true,dataType:"html",success:function(an){if(-1!=an.search(h.ANT)){al.append('<span class="wpmt_bozo_profile" >BOZO (ANT)</span>');al.parent().addClass("wpmt_bozo_post")}else{al.append('<span class="wpmt_bozo_profile" >BOZO</span>');al.parent().addClass("wpmt_bozo_post")}}})}else{K(this).append('<span class="wpmt_bozo_profile" >BOZO</span>');K(this).parent().addClass("wpmt_bozo_post")}++af}else{K(this).parent().addClass("wpmt_normal_post")}K(this).children().first("a").after(ah)}else{if(s(K(this).children("span.wpmt_bozo_profile"))){++af}}if(ak.attr("checked")){K(this).attr("style","background: "+g+";");K(this).addClass("post_selected")}else{K(this).css("background",am);K(this).removeClass("post_selected")}if((typeof(ag)!=="undefined")&&(ag===K(this).parent().attr("id"))){if(ak.attr("checked")){K(this).css("background",am);ak.attr("checked",false);K(this).removeClass("post_selected")}else{K(this).attr("style","background: "+g+";");ak.attr("checked",true);K(this).addClass("post_selected")}}});var ac=K("tbody > tr").length,ae=K("tbody > tr > "+C.column+":checked").length;if(ae<ac){K(C.bulk_actions_checkbox).attr("checked",false)}if(ae===ac){K(C.bulk_actions_checkbox).attr("checked",true)}var ab="";var ad=(C.topics)?"topic":"post";ab+="Current Page: "+ac+" "+ad+((ac===1)?"":"s");if(!C.topics){ab+=' &#10022; <span class="wpmt_profile_type">';ab+=(af>0)?af+" bozo"+((af===1)?"":"s"):"0 bozos";ab+="</span>";ab+=' &#10022; <span class="wpmt_profile_type wpmt_green">';ab+=(ac-af>0)?(ac-af)+" normal profile"+(((ac-af)===1)?"":"s"):"no normal profiles";ab+="</span>"}ab+=' | <span class="wpmt_profile_type wpmt_selected">';ab+=(ae>0)?ae+" "+ad+((ae===1)?"":"s")+" selected":"No "+ad+"s selected";ab+="</span> | ";C.stats.append(ab)}function S(){var ad=Z;var ac={};var ae={};var ab={};ad=ad.filter(function(){var af=K(this).find(C.author).text();if(ac[af]){return false}else{ac[af]=true;return true}});K.each(ad,function(af,ag){var ah=K(this).find(".post-ip-link").text();if(ah.length){if(ae[ah]){ab[ah]=true}else{ae[ah]=true}}});if(K.isEmptyObject(ab)){return}Z.each(function(){var ag=K(this).find(".post-ip-link");if(s(ag)===1){var af=ag.text();if(ab[af]){ag.before(K('<span class="wpmt_ip-warning">(DUPLICATE IP)</span><br />'))}}})}function B(){K("#yourtaglist").find("a").each(function(){if(K(this).text()==="modlook"){var ac=K(this).parents("li");if(s(ac)){parent_id=ac.attr("id").split("_");if(parent_id[1].length){if(N){var ab=parent_id[1];K.ajax({url:"https://wordpress.org/support/profile/"+parent_id[1],async:true,dataType:"html",success:function(ae){var ad=h.username.exec(ae);if(ad.length>=2){ab=ad[1]}ac.append(K('<a class="wpmt_modlook" href="https://wordpress.org/support/profile/'+parent_id[1]+'" title="modlook tagged by user '+parent_id[1]+'">'+ab+"</a>"))}})}else{ac.append(K('<a class="wpmt_modlook" href="https://wordpress.org/support/profile/'+parent_id[1]+'" title="modlook tagged by user '+parent_id[1]+'">'+parent_id[1]+"</a>"))}}}}})}function j(){var af=0,ab=0,ad=0;var ae=K("#ed_toolbar");if(s(ae)){var ac=K('<input id="moderator_tools_ed_uncap" class="moderator_tools_ed_button" type="button" value="l-case" accesskey="d">');ae.append(ac);K("#post_content").add(K("#topic")).select(function(ag){af=ag.target.selectionStart;ab=ag.target.selectionEnd;ad=K(this)});ac.bind("click.wpmt",function(aj){aj.preventDefault();if(ad){var ai=ad.val().substring(af,ab).toLowerCase();var ag=ad.val().substring(0,af)+ai+ad.val().substring(ab);ad.val(ag);ad.focus();var ah=ad.get(0);ah.selectionStart=ab;ah.selectionEnd=ab}af=ab=ad=0})}}function V(ab){var ac=K(ab).find("a");if(!s(K(ac))){return}K(ac).attr("href",function(){var ae=this.search;var ad=this.protocol+"//"+this.host+this.pathname;var af=false;if(ae){var ag=/view=all/g;if(!ag.test(ae)){af=ad+ae+"&view=all"}}else{af=ad+"?view=all"}if(af){return af+this.hash}return this})}function A(){el=K("form");if(s(el)){el.focusin(function(){E=true}).focusout(function(){E=false})}}function u(){K(document).bind("keyup.wpmt",function(ab){if(i.hasOwnProperty(ab.which)){delete i[ab.which]}})}function n(ab){i[ab.which]=true;return Object.keys(i).length}function W(ac){var ad=ac.offset().top;var ab=65;if(b.is(":visible")){ab=b.height();ab+=30}else{if((K(ac).height()+ab)>K(window).height()){ab=5}}ad=ad-ab;K("html, body").animate({scrollTop:ad},{duration:150})}function c(){if("hide"===U){b.hide();H.text("type m to display the menu")}else{if("show"===U){H.text("type m to hide the menu")}else{U="hide";b.hide();H.text("type m to display the menu")}}}function x(){if(s(Z)){Z.removeClass(e)}}function M(ab){i={};setTimeout(function(){window.open(ab,"_blank")},200)}function k(ab){if(!s(ab)){return""}var ac="";K.each(ab,function(ad,ae){ac+=y(ae)+"<br/>"});return ac}function y(ab){return ab.replace(/\%(.*?)\%/g,'<span class="wpmt_shortcut">$1</span>')}function s(ab){if(typeof(ab)!=="undefined"){return ab.length}return 0}T()});